# 定时器
Javascript是运行于单线程的环境中的，而定时器仅仅只是在未来的某个时间执行。

在Javascript中没*有任何代码是立即执行*的，但一旦进程空闲则尽快执行。

**定时器对队列的工作方式是，当特定时间过去后将代码插入(并不一定马上执行)**。如设定一个`150ms`后执行的定时器不代表到了`150ms`代码就立刻执行，它表示代码会在`150ms`后被加入到队列中。

## 重复的定时器
使用`setInterval()`时仅当没有该定时器的任何其他代码时，才将定时器代码添加到队列中，这确保了定时器代码**加入到队列中的最小时间间隔为指定间隔**。这种规则有两个问题：

1. **某些间隔会被跳过**

2. **多个定时器的代码执行之间的间隔可能会比预期的小**

假如给一个事件处理程序添加一个`setInterval()`函数。点触发该事件时，在运行到定时器代码时的指定时间后将其回调函数添加到队列，当*其他事件处理程序运行完毕*后便立即执行该定时器的回调函数;

如果在此代码运行期间，超过了定时器的时间间隔，那么就会将回调函数再次加入队列; 当第一个定时器代码运行时间超过1个单位以上定时器时间间隔时，之后的定时器便不会在添加到队列之中，之后**等待第一个定时器代码运行完成后便会立即执行**。

为了避免这个缺点，可以在定时器中*嵌套定时器*来解决这个问题。
```js
    setTimeout(() => {
      //代码
      setTimeout(arguments.callee, interval);
    }, interval);
```

每个浏览器窗口、标签页、或者`iframe`都有其*各自的代码执行队列*,对于这种情况最好是在接收`iframe`或者窗口中创建一个定时器来执行代码。
