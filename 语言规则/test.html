<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <script>
    'use strict';
//   let x = 1,y = 2;
//   x
//   ++
//   y   //x = 1, y = 3

//   function test(a) {
//     return
//     a;
//   }
//   test(1);//undefined
//   x = 9007199254740992;
//   // console.log(x + 1 == x); // true
//   // Array.prototype.toString = function () {
//   //   return 1;
//   // }
//   // Array.prototype.valueOf = function () {
//   //   return 2;
//   // }
//   // Date.prototype.toString = function () {
//   //   return 's';
//   // }
//   // Date.prototype.valueOf = function () {
//   //   return 1;
//   // }
//   // console.log(new Date()+1)
//   // var now = new Date();
//   // now + 1;//string
//   // now - 1;//number
//   // now == now.toString();//隐式和显式的字符串转换
//   // now > (now - 1);
//   var a = {n: 1};
//   // var b = a;
//   // a.x = a = {n: 2};
//   // a.x;//undefined
//   // b.x;//{ n: 2}
// //  Object.prototype.valueOf = function () {
// //    console.log('value')
// //    return {};
// //  };
// //  Object.prototype.toString = function () {
// //    console.log('toString');
// //    return 1;
// //  }
// //  Date.prototype.valueOf = function () {
// //     console.log('value')
// //     return 'ss';
// //   };
// //   Date.prototype.toString = function () {
// //     console.log('toString');
// //     return {};
// //   }
// //   function instanceOf(obj, constructor) {
// //       if (typeof constructor !== 'function') return new Error('typeError');

// //       while (obj) {
// //         obj = obj.__proto__;
// //         if (obj.constructor == constructor) {
// //           return true;
// //         }
// //       }
// //       return false;
// //     }
// // var data = [];
// // console.log(instanceOf(data, 1))
// var f = eval;
// eval('a+b');

// (function () {
//   eval('var a = 1;');
//   return a;// 异常，a未定义
// })();
// console.log(foo)
// function foo(){
//   console.log(this);
//   try{
//   throw new Error("1");
//   }finally{
//   return 1;//改写为 throw new Error("2")时
//   }
// }
// // console.log(foo.call({}));//返回1    抛出2错误，没有1错误
// console.log(foo)
// var foo = 5;
// console.log(foo)
// var obj = {
//   say: function () {
//     function _say() {
//       console.log(this);
//     }
//     console.log(obj);
//     return _say.bind(obj);
//   }()
// }
// obj.say();
// //undefind
// //undefind

// var a1 = [1, 2, 3, 4];
// var a2 = [5, 6, 7, 8];
// console.log(a1.concat(a2));
// console.log(a1,a2);
Function.prototype.pollycall = function (ctx) {
  ctx = ctx ? Object(ctx): window;
  var args = [];
  for(var i = 1; i < arguments.length; i++){
    args.push('arguments['+i+']');
  }
  ctx.fn = this;
  var result = eval('ctx.fn('+args.toString()+')');
  delete ctx.fn;
  return result;
}
var a = 5;
var obj = {
  a:1
};

function say(b,c,d) {
  console.log(this.a,b,c,d);
  return 999;
};

console.log(say.pollycall(null, 1, 2, 3));

console.log('\n');

Function.prototype.pollybind = function (ctx) {
  let args1 = [].slice.call(arguments,1);
  let that = this;
  return function () {
    let args2 = [].slice.call(arguments);
    let args = args1.concat(args2);
    return that.apply(ctx, args);
  }
}
  var value = 2;

  var foo = {
    value: 1
  };

  function bar(name, age) {
    return {
      value: this.value,
      name: name,
      age: age
    }
  };

  var bindFoo1 = bar.pollybind(foo, "Jack", 20); // 返回一个函数
  console.log(bindFoo1());

  function add(x) {
    function sum(y) {
      x = x + y;
      return sum;
    }
    sum.toString = function () {
      return x;
    }

    return sum;
  }
  console.log(add(1));
  console.log(add(1)(2));

  function instance(fn) {
    typeof fn == 'function'? '': new Error('???');
    let args = [].slice.call(arguments, 1);
    let obj = {};
    obj.__proto__ = fn.prototype;
    let result = fn.apply(obj, args);
    obj = typeof result == obj? obj: result;
    return obj;
  }

  function Car(color) {
      this.color = color;
    }
    Car.prototype.start = function () {
      console.log(this.color + " car start");
    }

    var car = instance(Car, "black");
    car.color;
    // black

    car.start();
// black car start
  </script>
</body>
</html>